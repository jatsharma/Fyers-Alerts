from time import time
import pandas as pd

from fyers_trade import FyersTrade

from os.path import exists

DATA_DIR = "../data/60min"

NIFTY_500 = ['NSE:3MINDIA-EQ', 'NSE:ABB-EQ', 'NSE:ACC-EQ', 'NSE:AIAENG-EQ', 'NSE:APLAPOLLO-EQ', 'NSE:AUBANK-EQ', 'NSE:AARTIDRUGS-EQ', 'NSE:AAVAS-EQ', 'NSE:ABBOTINDIA-EQ', 'NSE:ADANIENT-EQ', 'NSE:ADANIGREEN-EQ', 'NSE:ADANIPORTS-EQ', 'NSE:ATGL-EQ', 'NSE:ADANITRANS-EQ', 'NSE:ABCAPITAL-EQ', 'NSE:ABFRL-EQ', 'NSE:ABSLAMC-EQ', 'NSE:ADVENZYMES-EQ', 'NSE:AEGISCHEM-EQ', 'NSE:AFFLE-EQ', 'NSE:AJANTPHARM-EQ', 'NSE:APLLTD-EQ', 'NSE:ALKEM-EQ', 'NSE:ALKYLAMINE-EQ', 'NSE:ALLCARGO-EQ', 'NSE:ALOKINDS-EQ', 'NSE:AMARAJABAT-EQ', 'NSE:AMBER-EQ', 'NSE:AMBUJACEM-EQ', 'NSE:ANGELONE-EQ', 'NSE:ANURAS-EQ', 'NSE:APOLLOHOSP-EQ', 'NSE:APOLLOTYRE-EQ', 'NSE:APTUS-EQ', 'NSE:ASAHIINDIA-EQ', 'NSE:ASHOKLEY-EQ', 'NSE:ASIANPAINT-EQ', 'NSE:ASTERDM-EQ', 'NSE:ASTRAZEN-EQ', 'NSE:ASTRAL-EQ', 'NSE:ATUL-EQ', 'NSE:AUROPHARMA-EQ', 'NSE:AVANTIFEED-EQ', 'NSE:DMART-EQ', 'NSE:AXISBANK-EQ', 'NSE:BASF-EQ', 'NSE:BSE-EQ', 'NSE:BAJAJ-AUTO-EQ', 'NSE:BAJAJELEC-EQ', 'NSE:BAJFINANCE-EQ', 'NSE:BAJAJFINSV-EQ', 'NSE:BAJAJHLDNG-EQ', 'NSE:BALAMINES-EQ', 'NSE:BALKRISIND-EQ', 'NSE:BALRAMCHIN-EQ', 'NSE:BANDHANBNK-EQ', 'NSE:BANKBARODA-EQ', 'NSE:BANKINDIA-EQ', 'NSE:MAHABANK-EQ', 'NSE:BATAINDIA-EQ', 'NSE:BAYERCROP-EQ', 'NSE:BERGEPAINT-EQ', 'NSE:BDL-EQ', 'NSE:BEL-EQ', 'NSE:BHARATFORG-EQ', 'NSE:BHEL-EQ', 'NSE:BPCL-EQ', 'NSE:BHARTIARTL-EQ', 'NSE:BIOCON-EQ', 'NSE:BIRLACORPN-EQ', 'NSE:BSOFT-EQ', 'NSE:BLUEDART-EQ', 'NSE:BLUESTARCO-EQ', 'NSE:BBTC-EQ', 'NSE:BORORENEW-EQ', 'NSE:BOSCHLTD-EQ', 'NSE:BRIGADE-EQ', 'NSE:BCG-EQ', 'NSE:BRITANNIA-EQ', 'NSE:MAPMYINDIA-EQ', 'NSE:CCL-EQ', 'NSE:CESC-EQ', 'NSE:CGPOWER-EQ', 'NSE:CRISIL-EQ', 'NSE:CSBBANK-EQ', 'NSE:CANFINHOME-EQ', 'NSE:CANBK-EQ', 'NSE:CAPLIPOINT-EQ', 'NSE:CGCL-EQ', 'NSE:CARBORUNIV-EQ', 'NSE:CASTROLIND-EQ', 'NSE:CEATLTD-EQ', 'NSE:CENTRALBK-EQ', 'NSE:CDSL-EQ', 'NSE:CENTURYPLY-EQ', 'NSE:CENTURYTEX-EQ', 'NSE:CERA-EQ', 'NSE:CHALET-EQ', 'NSE:CHAMBLFERT-EQ', 'NSE:CHEMPLASTS-EQ', 'NSE:CHOLAHLDNG-EQ', 'NSE:CHOLAFIN-EQ', 'NSE:CIPLA-EQ', 'NSE:CUB-EQ', 'NSE:CLEAN-EQ', 'NSE:COALINDIA-EQ', 'NSE:COCHINSHIP-EQ', 'NSE:COFORGE-EQ', 'NSE:COLPAL-EQ', 'NSE:CAMS-EQ', 'NSE:CONCOR-EQ', 'NSE:COROMANDEL-EQ', 'NSE:CREDITACC-EQ', 'NSE:CROMPTON-EQ', 'NSE:CUMMINSIND-EQ', 'NSE:CYIENT-EQ', 'NSE:DCMSHRIRAM-EQ', 'NSE:DLF-EQ', 'NSE:DABUR-EQ', 'NSE:DALBHARAT-EQ', 'NSE:DEEPAKNTR-EQ', 'NSE:DELTACORP-EQ', 'NSE:DEVYANI-EQ', 'NSE:DHANI-EQ', 'NSE:DBL-EQ', 'NSE:DIVISLAB-EQ', 'NSE:DIXON-EQ', 'NSE:LALPATHLAB-EQ', 'NSE:DRREDDY-EQ', 'NSE:EIDPARRY-EQ', 'NSE:EIHOTEL-EQ', 'NSE:EPL-EQ', 'NSE:EASEMYTRIP-EQ', 'NSE:EDELWEISS-EQ', 'NSE:EICHERMOT-EQ', 'NSE:ELGIEQUIP-EQ', 'NSE:EMAMILTD-EQ', 'NSE:ENDURANCE-EQ', 'NSE:ENGINERSIN-EQ', 'NSE:EQUITAS-EQ', 'NSE:EQUITASBNK-EQ', 'NSE:ERIS-EQ', 'NSE:ESCORTS-EQ', 'NSE:EXIDEIND-EQ', 'NSE:FDC-EQ', 'NSE:NYKAA-EQ', 'NSE:FEDERALBNK-EQ', 'NSE:FACT-EQ', 'NSE:FINEORG-EQ', 'NSE:FINCABLES-EQ', 'NSE:FINPIPE-EQ', 'NSE:FSL-EQ', 'NSE:FORTIS-EQ', 'NSE:GRINFRA-EQ', 'NSE:GAIL-EQ', 'NSE:GMMPFAUDLR-EQ', 'NSE:GMRINFRA-EQ', 'NSE:GALAXYSURF-EQ', 'NSE:GARFIBRES-EQ', 'NSE:GICRE-EQ', 'NSE:GLAND-EQ', 'NSE:GLAXO-EQ', 'NSE:GLS-EQ', 'NSE:GLENMARK-EQ', 'NSE:GOCOLORS-EQ', 'NSE:GODFRYPHLP-EQ', 'NSE:GODREJAGRO-EQ', 'NSE:GODREJCP-EQ', 'NSE:GODREJIND-EQ', 'NSE:GODREJPROP-EQ', 'NSE:GRANULES-EQ', 'NSE:GRAPHITE-EQ', 'NSE:GRASIM-EQ', 'NSE:GESHIP-EQ', 'NSE:GRINDWELL-EQ', 'NSE:GUJALKALI-EQ', 'NSE:GAEL-EQ', 'NSE:FLUOROCHEM-EQ', 'NSE:GUJGASLTD-EQ', 'NSE:GNFC-EQ', 'NSE:GPPL-EQ', 'NSE:GSFC-EQ', 'NSE:GSPL-EQ', 'NSE:HEG-EQ', 'NSE:HCLTECH-EQ', 'NSE:HDFCAMC-EQ', 'NSE:HDFCBANK-EQ', 'NSE:HDFCLIFE-EQ', 'NSE:HFCL-EQ', 'NSE:HLEGLAS-EQ', 'NSE:HAPPSTMNDS-EQ', 'NSE:HATHWAY-EQ', 'NSE:HATSUN-EQ', 'NSE:HAVELLS-EQ', 'NSE:HEMIPROP-EQ', 'NSE:HEROMOTOCO-EQ', 'NSE:HIKAL-EQ', 'NSE:HINDALCO-EQ', 'NSE:HGS-EQ', 'NSE:HAL-EQ', 'NSE:HINDCOPPER-EQ', 'NSE:HINDPETRO-EQ', 'NSE:HINDUNILVR-EQ', 'NSE:HINDZINC-EQ', 'NSE:POWERINDIA-EQ', 'NSE:HOMEFIRST-EQ', 'NSE:HONAUT-EQ', 'NSE:HUDCO-EQ', 'NSE:HDFC-EQ', 'NSE:ICICIBANK-EQ', 'NSE:ICICIGI-EQ', 'NSE:ICICIPRULI-EQ', 'NSE:ISEC-EQ', 'NSE:IDBI-EQ', 'NSE:IDFCFIRSTB-EQ', 'NSE:IDFC-EQ', 'NSE:IFBIND-EQ', 'NSE:IIFL-EQ', 'NSE:IIFLWAM-EQ', 'NSE:IRB-EQ', 'NSE:IRCON-EQ', 'NSE:ITC-EQ', 'NSE:ITI-EQ', 'NSE:INDIACEM-EQ', 'NSE:IBULHSGFIN-EQ', 'NSE:IBREALEST-EQ', 'NSE:INDIAMART-EQ', 'NSE:INDIANB-EQ', 'NSE:IEX-EQ', 'NSE:INDHOTEL-EQ', 'NSE:IOC-EQ', 'NSE:IOB-EQ', 'NSE:IRCTC-EQ', 'NSE:IRFC-EQ', 'NSE:INDIGOPNTS-EQ', 'NSE:ICIL-EQ', 'NSE:INDOCO-EQ', 'NSE:IGL-EQ', 'NSE:INDUSTOWER-EQ', 'NSE:INDUSINDBK-EQ', 'NSE:INFIBEAM-EQ', 'NSE:NAUKRI-EQ', 'NSE:INFY-EQ', 'NSE:INOXLEISUR-EQ', 'NSE:INTELLECT-EQ', 'NSE:INDIGO-EQ', 'NSE:IPCALAB-EQ', 'NSE:JBCHEPHARM-EQ', 'NSE:JKCEMENT-EQ', 'NSE:JKLAKSHMI-EQ', 'NSE:JKPAPER-EQ', 'NSE:JMFINANCIL-EQ', 'NSE:JSWENERGY-EQ', 'NSE:JSWSTEEL-EQ', 'NSE:JAMNAAUTO-EQ', 'NSE:JSL-EQ', 'NSE:JINDALSTEL-EQ', 'NSE:JUBLFOOD-EQ', 'NSE:JUBLINGREA-EQ', 'NSE:JUBLPHARMA-EQ', 'NSE:JUSTDIAL-EQ', 'NSE:JYOTHYLAB-EQ', 'NSE:KPRMILL-EQ', 'NSE:KEI-EQ', 'NSE:KNRCON-EQ', 'NSE:KPITTECH-EQ', 'NSE:KRBL-EQ', 'NSE:KAJARIACER-EQ', 'NSE:KALPATPOWR-EQ', 'NSE:KALYANKJIL-EQ', 'NSE:KANSAINER-EQ', 'NSE:KARURVYSYA-EQ', 'NSE:KEC-EQ', 'NSE:KOTAKBANK-EQ', 'NSE:KIMS-EQ', 'NSE:L&TFH-EQ', 'NSE:LTTS-EQ', 'NSE:LICHSGFIN-EQ', 'NSE:LAXMIMACH-EQ', 'NSE:LTI-EQ', 'NSE:LT-EQ', 'NSE:LATENTVIEW-EQ', 'NSE:LAURUSLABS-EQ', 'NSE:LXCHEM-EQ', 'NSE:LINDEINDIA-EQ', 'NSE:LUPIN-EQ', 'NSE:LUXIND-EQ', 'NSE:MMTC-EQ', 'NSE:MOIL-EQ', 'NSE:MRF-EQ', 'NSE:MTARTECH-EQ', 'NSE:LODHA-EQ', 'NSE:MGL-EQ', 'NSE:M&MFIN-EQ', 'NSE:M&M-EQ', 'NSE:MAHINDCIE-EQ', 'NSE:MHRIL-EQ', 'NSE:MAHLOG-EQ', 'NSE:MANAPPURAM-EQ', 'NSE:MRPL-EQ', 'NSE:MARICO-EQ', 'NSE:MARUTI-EQ', 'NSE:MASTEK-EQ', 'NSE:MFSL-EQ', 'NSE:MAXHEALTH-EQ', 'NSE:MAZDOCK-EQ', 'NSE:MEDPLUS-EQ', 'NSE:METROBRAND-EQ', 'NSE:METROPOLIS-EQ', 'NSE:MINDTREE-EQ', 'NSE:MINDAIND-EQ', 'NSE:MOTILALOFS-EQ', 'NSE:MPHASIS-EQ', 'NSE:MCX-EQ', 'NSE:MUTHOOTFIN-EQ', 'NSE:NATCOPHARM-EQ', 'NSE:NBCC-EQ', 'NSE:NCC-EQ', 'NSE:NESCO-EQ', 'NSE:NHPC-EQ', 'NSE:NLCINDIA-EQ', 'NSE:NMDC-EQ', 'NSE:NOCIL-EQ', 'NSE:NTPC-EQ', 'NSE:NH-EQ', 'NSE:NATIONALUM-EQ', 'NSE:NAVINFLUOR-EQ', 'NSE:NAZARA-EQ', 'NSE:NESTLEIND-EQ', 'NSE:NETWORK18-EQ', 'NSE:NAM-INDIA-EQ', 'NSE:NUVOCO-EQ', 'NSE:OBEROIRLTY-EQ', 'NSE:ONGC-EQ', 'NSE:OIL-EQ', 'NSE:PAYTM-EQ', 'NSE:OFSS-EQ', 'NSE:ORIENTELEC-EQ', 'NSE:POLICYBZR-EQ', 'NSE:PCBL-EQ', 'NSE:PIIND-EQ', 'NSE:PNBHOUSING-EQ', 'NSE:PNCINFRA-EQ', 'NSE:PVR-EQ', 'NSE:PAGEIND-EQ', 'NSE:PERSISTENT-EQ', 'NSE:PETRONET-EQ', 'NSE:PFIZER-EQ', 'NSE:PHOENIXLTD-EQ', 'NSE:PIDILITIND-EQ', 'NSE:PEL-EQ', 'NSE:POLYMED-EQ', 'NSE:POLYCAB-EQ', 'NSE:POLYPLEX-EQ', 'NSE:POONAWALLA-EQ', 'NSE:PFC-EQ', 'NSE:POWERGRID-EQ', 'NSE:PRAJIND-EQ', 'NSE:PRESTIGE-EQ', 'NSE:PRINCEPIPE-EQ', 'NSE:PRSMJOHNSN-EQ', 'NSE:PRIVISCL-EQ', 'NSE:PGHL-EQ', 'NSE:PGHH-EQ', 'NSE:PNB-EQ', 'NSE:QUESS-EQ', 'NSE:RBLBANK-EQ', 'NSE:RECLTD-EQ', 'NSE:RHIM-EQ', 'NSE:RITES-EQ', 'NSE:RADICO-EQ', 'NSE:RVNL-EQ', 'NSE:RAILTEL-EQ', 'NSE:RAIN-EQ', 'NSE:RAJESHEXPO-EQ', 'NSE:RALLIS-EQ', 'NSE:RCF-EQ', 'NSE:RATNAMANI-EQ', 'NSE:RTNINDIA-EQ', 'NSE:REDINGTON-EQ', 'NSE:RELAXO-EQ', 'NSE:RELIANCE-EQ', 'NSE:RBA-EQ', 'NSE:ROSSARI-EQ', 'NSE:ROUTE-EQ', 'NSE:SBICARD-EQ', 'NSE:SBILIFE-EQ', 'NSE:SIS-EQ', 'NSE:SJVN-EQ', 'NSE:SKFINDIA-EQ', 'NSE:SRF-EQ', 'NSE:SANOFI-EQ', 'NSE:SAPPHIRE-EQ', 'NSE:SAREGAMA-EQ', 'NSE:SCHAEFFLER-EQ', 'NSE:SEQUENT-EQ', 'NSE:SFL-EQ', 'NSE:SHILPAMED-EQ', 'NSE:SCI-EQ', 'NSE:SHREECEM-EQ', 'NSE:RENUKA-EQ', 'NSE:SHRIRAMCIT-EQ', 'NSE:SRTRANSFIN-EQ', 'NSE:SHYAMMETL-EQ', 'NSE:SIEMENS-EQ', 'NSE:SOBHA-EQ', 'NSE:SOLARINDS-EQ', 'NSE:SOLARA-EQ', 'NSE:SONACOMS-EQ', 'NSE:SONATSOFTW-EQ', 'NSE:SPICEJET-EQ', 'NSE:STARHEALTH-EQ', 'NSE:SBIN-EQ', 'NSE:SAIL-EQ', 'NSE:SWSOLAR-EQ', 'NSE:STLTECH-EQ', 'NSE:STAR-EQ', 'NSE:SUDARSCHEM-EQ', 'NSE:SUMICHEM-EQ', 'NSE:SPARC-EQ', 'NSE:SUNPHARMA-EQ', 'NSE:SUNTV-EQ', 'NSE:SUNDARMFIN-EQ', 'NSE:SUNDRMFAST-EQ', 'NSE:SUNTECK-EQ', 'NSE:SUPRAJIT-EQ', 'NSE:SUPREMEIND-EQ', 'NSE:SUVENPHAR-EQ', 'NSE:SUZLON-EQ', 'NSE:SYMPHONY-EQ', 'NSE:SYNGENE-EQ', 'NSE:TCIEXP-EQ', 'NSE:TCNSBRANDS-EQ', 'NSE:TTKPRESTIG-EQ', 'NSE:TV18BRDCST-EQ', 'NSE:TVSMOTOR-EQ', 'NSE:TANLA-EQ', 'NSE:TATACHEM-EQ', 'NSE:TATACOFFEE-EQ', 'NSE:TATACOMM-EQ', 'NSE:TCS-EQ', 'NSE:TATACONSUM-EQ', 'NSE:TATAELXSI-EQ', 'NSE:TATAINVEST-EQ', 'NSE:TATAMTRDVR-EQ', 'NSE:TATAMOTORS-EQ', 'NSE:TATAPOWER-EQ', 'NSE:TATASTLLP-EQ', 'NSE:TATASTEEL-EQ', 'NSE:TTML-EQ', 'NSE:TEAMLEASE-EQ', 'NSE:TECHM-EQ', 'NSE:NIACL-EQ', 'NSE:RAMCOCEM-EQ', 'NSE:THERMAX-EQ', 'NSE:THYROCARE-EQ', 'NSE:TIMKEN-EQ', 'NSE:TITAN-EQ', 'NSE:TORNTPHARM-EQ', 'NSE:TORNTPOWER-EQ', 'NSE:TRENT-EQ', 'NSE:TRIDENT-EQ', 'NSE:TRIVENI-EQ', 'NSE:TRITURBINE-EQ', 'NSE:TIINDIA-EQ', 'NSE:UCOBANK-EQ', 'NSE:UFLEX-EQ', 'NSE:UPL-EQ', 'NSE:UTIAMC-EQ', 'NSE:ULTRACEMCO-EQ', 'NSE:UNIONBANK-EQ', 'NSE:UBL-EQ', 'NSE:MCDOWELL-N-EQ', 'NSE:VGUARD-EQ', 'NSE:VMART-EQ', 'NSE:VIPIND-EQ', 'NSE:VAIBHAVGBL-EQ', 'NSE:VAKRANGEE-EQ', 'NSE:VTL-EQ', 'NSE:VARROC-EQ', 'NSE:VBL-EQ', 'NSE:VEDL-EQ', 'NSE:VENKEYS-EQ', 'NSE:VIJAYA-EQ', 'NSE:VINATIORGA-EQ', 'NSE:IDEA-EQ', 'NSE:VOLTAS-EQ', 'NSE:WELCORP-EQ', 'NSE:WELSPUNIND-EQ', 'NSE:WESTLIFE-EQ', 'NSE:WHIRLPOOL-EQ', 'NSE:WIPRO-EQ', 'NSE:WOCKPHARMA-EQ', 'NSE:YESBANK-EQ', 'NSE:ZFCVINDIA-EQ', 'NSE:ZEEL-EQ', 'NSE:ZENSARTECH-EQ', 'NSE:ZOMATO-EQ', 'NSE:ZYDUSLIFE-EQ', 'NSE:ZYDUSWELL-EQ', 'NSE:ECLERX-EQ']

def save_data():
    FYERS = FyersTrade()
    now_time = int(time())
    resolution = "60"
    range_from = now_time - (86400 * 3000)
    range_to = now_time
    # symbol = "NSE:SBIN-EQ"
    for symbol in NIFTY_500:
        print(symbol)
        if not exists(f"{DATA_DIR}/{symbol.replace(':', '-')}.csv"):
            # print(range_from, range_to)
            data_df = FYERS.get_historical_data(symbol, resolution, range_from, range_to)
            if data_df is not None:
                print(data_df)
                file_name = f"{DATA_DIR}/{symbol.replace(':', '-')}.csv"
                pd.DataFrame.to_csv(data_df, file_name, index=False)

def get_all_scripts():
    x = list()
    data = pd.read_csv("ind_nifty500list.csv")
    for script in data['Symbol']:
        s = f"NSE:{script}-EQ"
        # print(s)
        x.append(s)
    print(x)

if __name__ == "__main__":
    save_data()
    # get_all_scripts()